# 统一时间轴功能说明

## 功能概述

统一时间轴功能解决了股票预测图表中一个常见问题：**预测数据和源数据的折线长度在视觉上不一致**。

### 问题背景

在原始的图表中：
- 预测数据可能包含非交易时间（如夜间、周末）
- 源数据只包含交易时间
- 即使预测相同的时间跨度，两条折线的视觉长度可能不同
- 这影响了对预测趋势的直观对比

### 解决方案

统一时间轴功能通过以下方式解决问题：
1. **统一X轴索引**：使用数值索引而非时间戳作为X轴
2. **等长显示**：预测数据和真实数据在图表上显示为相同长度
3. **关键时间点标注**：在X轴上标注重要的时间点
4. **视觉分界线**：添加垂直线标示预测起点

## 使用方法

### 1. 配置文件设置

在 `config.yaml` 中添加或修改以下配置：

```yaml
chart:
  use_unified_time_axis: true  # 启用统一时间轴
  figure_size: [16, 12]
  dpi: 300
  save_format: 'png'
  # 其他图表配置...
```

### 2. 配置选项说明

| 配置项 | 类型 | 默认值 | 说明 |
|--------|------|--------|------|
| `use_unified_time_axis` | boolean | `true` | 是否启用统一时间轴 |

- `true`: 使用统一时间轴模式
- `false`: 使用传统时间轴模式

### 3. 运行预测

```bash
# 使用默认配置（启用统一时间轴）
./kronos_venv/bin/python predict_with_config.py --symbol BTC-USD

# 或者指定自定义配置文件
./kronos_venv/bin/python predict_with_config.py --config custom_config.yaml --symbol BTC-USD
```

## 功能特点

### 统一时间轴模式

✅ **优点：**
- 预测数据和真实数据长度在视觉上相同
- 便于对比预测趋势和实际趋势
- 不受时间密度差异影响
- 图表更加整齐美观

⚠️ **注意：**
- X轴显示关键时间点，不是连续时间
- 适合趋势分析，不适合精确时间定位

### 传统时间轴模式

✅ **优点：**
- 显示真实的时间戳
- 可以精确查看具体时间点
- 时间跨度直观可见

⚠️ **注意：**
- 预测数据和真实数据折线长度可能不同
- 包含非交易时间的预测数据会显得更密集

## 图表识别

### 统一时间轴图表特征：
- 图表标题包含 `(统一时间轴)` 标识
- X轴显示关键时间点（起始、结束等）
- 有垂直虚线标示预测起点
- 预测线和真实线长度相同

### 传统时间轴图表特征：
- 图表标题不包含特殊标识
- X轴显示连续的时间戳
- 预测线和真实线长度可能不同

## 使用场景

### 推荐使用统一时间轴：
- 🎯 **趋势对比分析**：重点关注预测趋势是否与实际趋势一致
- 📊 **模型性能评估**：评估预测模型的准确性
- 🔍 **视觉对比**：需要清晰对比预测和实际的价格走势
- 📈 **演示报告**：制作图表用于展示或报告

### 推荐使用传统时间轴：
- 🕐 **时间精确性**：需要查看具体的时间点
- 📅 **时间跨度分析**：关注实际的时间跨度
- 🔍 **细节分析**：需要精确的时间定位
- 📋 **数据审计**：验证预测数据的时间准确性

## 技术实现

### 核心方法

1. **`create_unified_time_axis()`**：创建统一的价格时间轴
2. **`create_unified_volume_axis()`**：创建统一的成交量时间轴
3. **条件渲染**：根据配置选择渲染模式

### 数据处理流程

```
历史数据 → 统一索引 → 图表绘制
真实数据 → 统一索引 → 图表绘制  
预测数据 → 统一索引 → 图表绘制
```

## 示例对比

### 运行演示脚本

```bash
./kronos_venv/bin/python demo_unified_axis.py
```

这个脚本会：
1. 生成传统时间轴图表
2. 生成统一时间轴图表
3. 显示详细的对比说明

## 常见问题

### Q: 如何切换时间轴模式？
A: 在配置文件中设置 `use_unified_time_axis: false` 即可切换到传统模式。

### Q: 统一时间轴会影响预测准确性吗？
A: 不会。统一时间轴只影响图表显示，不影响预测算法和结果。

### Q: 可以同时生成两种图表吗？
A: 目前不支持。需要修改配置文件并重新运行来生成不同模式的图表。

### Q: 时间标签显示不完整怎么办？
A: 可以调整 `figure_size` 配置来增加图表尺寸，或者减少时间标签的数量。

## 更新日志

- **v1.0** (2025-10-10): 初始版本，支持统一时间轴和传统时间轴切换
- 支持价格对比、成交量对比、价格误差、价格变化趋势四个子图
- 支持未来预测图表的统一时间轴模式
- 添加配置选项和演示脚本

---

📝 **注意**：此功能已集成到 `predict_with_config.py` 中，无需额外安装或配置。
